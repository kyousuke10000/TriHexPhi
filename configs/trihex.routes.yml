# TriHexÎ¦ Routing Rules v1.1
# 
# ã“ã‚Œã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®ã®å”¯ä¸€ã®çœŸå®Ÿï¼ˆSSOTï¼‰ã§ã™ã€‚
# Janitorã¯ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã‚“ã§è‡ªå‹•ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç§»å‹•ã—ã¾ã™ã€‚
#
# æ›´æ–°æ—¥: 2025-10-27
# æ‰¿èª: GPT-5ï¼ˆçµ±æ²»å°†è»ï¼‰

version: 1.1

# ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¦å‰‡
rules:
  # Storyï¼ˆç‰©èªï¼‰
  - when:   { kind: "story", lang: "ja" }
    target: "stories/ja/{date}_{slug}.md"
    description: "æ—¥æœ¬èªã®ç‰©èªãƒ»è¨˜éŒ²"
  
  - when:   { kind: "story", lang: "en" }
    target: "stories/en/{date}_{slug}.md"
    description: "è‹±èªã®ç‰©èªãƒ»è¨˜éŒ²"
  
  # Specï¼ˆä»•æ§˜æ›¸ï¼‰
  - when:   { kind: "spec" }
    target: "specs/{slug}.md"
    description: "æŠ€è¡“ä»•æ§˜æ›¸ï¼ˆè¨€èªä¸å•ï¼‰"
  
  # Decisionï¼ˆæ±ºå®šæ–‡æ›¸ï¼‰
  - when:   { kind: "decision" }
    target: "decisions/{date}_{slug}.md"
    description: "é‡è¦ãªæ±ºå®šã®è¨˜éŒ²"
  
  # Logï¼ˆãƒ­ã‚°ãƒ»è¨˜éŒ²ï¼‰
  - when:   { kind: "log" }
    target: "docs/logs/{date}_{slug}.md"
    description: "æ—¥ã€…ã®ãƒ­ã‚°ãƒ»ä½œæ¥­è¨˜éŒ²"
  
  # Summaryï¼ˆã‚µãƒãƒªãƒ¼ãƒ»è¦ç´„ï¼‰
  - when:   { kind: "summary" }
    target: "docs/summaries/{date}_{slug}.md"
    description: "è¦ç´„æ–‡æ›¸"
  
  # Letterï¼ˆæ‰‹ç´™ãƒ»é€šä¿¡ï¼‰
  - when:   { kind: "letter" }
    target: "docs/letters/{date}_{slug}.md"
    description: "AIé–“ã®æ‰‹ç´™ãƒ»é€šä¿¡"
  
  # Docï¼ˆä¸€èˆ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰
  - when:   { kind: "doc" }
    target: "docs/{slug}.md"
    description: "ä¸€èˆ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ"

# å‘½åè¦å‰‡
naming:
  # Slugï¼ˆURLå®‰å…¨ãªè­˜åˆ¥å­ï¼‰
  slug_regex: "^[a-z0-9-]+$"
  slug_max_length: 100
  
  # æ—¥ä»˜å½¢å¼
  date_regex: "^20\\d{2}-\\d{2}-\\d{2}$"
  date_format: "YYYY-MM-DD"
  
  # ãƒ•ã‚¡ã‚¤ãƒ«åç”Ÿæˆãƒ«ãƒ¼ãƒ«
  # ã‚¿ã‚¤ãƒˆãƒ« â†’ slugå¤‰æ›:
  # 1. å°æ–‡å­—åŒ–
  # 2. è‹±æ•°å­—ä»¥å¤–ã‚’"-"ã«
  # 3. é€£ç¶š"-"ã‚’1ã¤ã«
  # 4. å‰å¾Œã®"-"ã‚’å‰Šé™¤

# ä¾‹å¤–ï¼ˆæ—¢å­˜æ§‹é€ ã¯ãƒ«ãƒ¼ãƒ«é©ç”¨å¤–ï¼‰
exceptions:
  # æ­´å²çš„è¨˜éŒ²ã¨ã—ã¦ä¿å­˜
  - "00_CORE/**"
  - "10_CAPTURE_MIZUKAGAMI/**"
  - "20_CRYSTALLIZATION_KOKUYOU/**"
  - "30_MEMORY_SHINSEN/**"
  - "ğŸ“¤Round3_å…¨AIé€ä»˜ç”¨/**"
  - "ğŸ“ŠREPORTS/**"
  
  # ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚¡ã‚¤ãƒ«
  - ".github/**"
  - ".vscode/**"
  - "node_modules/**"
  - "_inbox/README.md"  # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«è‡ªä½“ã¯ç§»å‹•ã—ãªã„

# Janitorå‹•ä½œè¨­å®šï¼ˆå‚ç…§ç”¨ã€å®Ÿéš›ã®è¨­å®šã¯janitor.config.ymlï¼‰
janitor:
  # å‡¦ç†å¯¾è±¡
  watch_paths:
    - "_inbox/**/*.md"
  
  # ç„¡è¦–ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«
  ignore_patterns:
    - "_inbox/README.md"
    - "_inbox/.gitkeep"
  
  # ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
  commit_message: "chore(janitor): route inbox files per trihex.routes.yml"

# ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®šï¼ˆå‚ç…§ç”¨ã€å®Ÿéš›ã®è¨­å®šã¯validate.config.ymlï¼‰
validation:
  # å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  required_fields:
    - "kind"
    - "lang"
    - "date"
    - "title"
    - "author"
    - "status"
    - "visibility"
  
  # è¨±å¯ã•ã‚Œã‚‹å€¤
  allowed_values:
    kind:
      - "story"
      - "spec"
      - "decision"
      - "log"
      - "summary"
      - "letter"
      - "doc"
    
    lang:
      - "ja"
      - "en"
    
    author:
      - "GPT5"
      - "Claude"
      - "Gemini"
      - "Grok"
      - "DeepSeek"
      - "Cursor"
      - "CEO"
    
    status:
      - "draft"
      - "review"
      - "final"
    
    tier:
      - 1
      - 2
      - 3
    
    visibility:
      - "internal"
      - "public"

# ä½¿ç”¨ä¾‹
examples:
  - input:
      kind: "story"
      lang: "ja"
      date: "2025-10-27"
      title: "TriHexÎ¦ãƒ¢ãƒ¼ãƒ‰èµ·å‹•ã®è¨˜éŒ²"
    output: "stories/ja/2025-10-27_trihexphi-mode-activation.md"
  
  - input:
      kind: "decision"
      date: "2025-10-27"
      title: "è‹±è¨³æˆ¦ç•¥ v1.0"
    output: "decisions/2025-10-27_english-translation-strategy-v1-0.md"
  
  - input:
      kind: "spec"
      title: "MIZUKAGAMI Memory System"
    output: "specs/mizukagami-memory-system.md"

# å¤‰æ›´å±¥æ­´
changelog:
  - version: "1.1"
    date: "2025-10-27"
    author: "GPT5 + Cursor"
    changes:
      - "åˆç‰ˆä½œæˆ"
      - "7ç¨®é¡ã®kindã‚’å®šç¾©"
      - "æ—¢å­˜æ§‹é€ ã®ä¾‹å¤–è¨­å®š"
      - "å‘½åè¦å‰‡ã®æ˜æ–‡åŒ–"
  
  - version: "1.0"
    date: "2025-10-27"
    author: "GPT5"
    changes:
      - "ã‚³ãƒ³ã‚»ãƒ—ãƒˆææ¡ˆ"

# é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
related:
  - "decisions/DEC_2025-10-27_FS-GUARDRAILS_v1.md"
  - "configs/janitor.config.yml"
  - "_inbox/README.md"

