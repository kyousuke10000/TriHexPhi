name: ğŸ”± TriHexÎ¦ Knowledge Sync

on:
  schedule:
    - cron: "0 0 * * *"  # æ¯æ—¥JSTæœ9æ™‚ï¼ˆUTC 0æ™‚ï¼‰
  workflow_dispatch:  # æ‰‹å‹•å®Ÿè¡Œã‚‚å¯èƒ½

jobs:
  sync:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Build context-bootstrap
        run: |
          bash .trihex/scripts/generate-context-bootstrap.sh
      
      - name: Verify context-bootstrap
        run: |
          if [ -f ".trihex/context-bootstrap.txt" ]; then
            echo "âœ… Context Bootstrap ç”ŸæˆæˆåŠŸ"
            wc -l .trihex/context-bootstrap.txt
          else
            echo "âŒ Context Bootstrap ç”Ÿæˆå¤±æ•—"
            exit 1
          fi
      
      - name: Archive context-bootstrap
        uses: actions/upload-artifact@v3
        with:
          name: context-bootstrap
          path: .trihex/context-bootstrap.txt
      
      - name: Commit if changed
        run: |
          git config user.name "TriHexÎ¦ Actions"
          git config user.email "actions@trihexphi.local"
          git add .trihex/context-bootstrap.txt || true
          git diff --cached --quiet || git commit -m "ğŸ”„ Context Bootstrap è‡ªå‹•æ›´æ–° $(date '+%Y-%m-%d')"

